<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>语海</title>
    <description>井蛙不可以语于海者</description>
    <link>http://localhost:4000/Outside-man.github.io/</link>
    <atom:link href="http://localhost:4000/Outside-man.github.io/feed.xml" rel="self" type="application/rss+xml" />
    <pubDate>Thu, 22 Mar 2018 21:28:07 +0800</pubDate>
    <lastBuildDate>Thu, 22 Mar 2018 21:28:07 +0800</lastBuildDate>
    <generator>Jekyll v3.7.3</generator>
    
      <item>
        <title>docker小记</title>
        <description>&lt;p&gt;因为之前有用过docker，但是每次要配置docker容器的时候，又会忘了常用指令，这篇博文打算好好记录下docker的使用。&lt;/p&gt;

&lt;p&gt;首先先介绍下docker，在我的理解中docker是一个容器，我们开发的应用、依赖和环境都可以打包部署到docker中，然后docker进行打包，之后这个包就可以直接部署到任意一台拥有docker服务的机器上。&lt;br /&gt;
这为我们解决了环境和依赖的问题，之前开发中遇到的问题&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;-这个应用装到生成环境之后咋报错了呢&lt;br /&gt;
  -不可能，我开发环境完全ojbk啊&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;-我感觉我需要的环境依赖都配置好，怎么这个demo还是跑不起了呢&lt;br /&gt;
  -你的xxx是不是没装，你的xxx是不是没配好&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;以上这些问题都会因为docker的存在而解决了，因为配置所需要的环境和依赖都随着应有一起打包了。&lt;/p&gt;

&lt;p&gt;docker中的容器与镜像的概念，他们的关系类似于对象和类，容器通过镜像生成，我们运行的是容器，打包出来的是镜像文件。这两个概念会穿插在整个docker中。&lt;/p&gt;

&lt;p&gt;安装docker就不多说了，直接开始常用指令。&lt;/p&gt;
&lt;h6 id=&quot;镜像images&quot;&gt;镜像(images)&lt;/h6&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$docker images #列出所有镜像
# -q 静默模式展示(只列出imageId)

$docker run [参数] [image] [command] #创建并运行容器
# -d 以守护进程方式运行（后台）
# -i 以交互模式运行容器，通常与 -t 同时使用
# -t 为容器重新分配一个伪输入终端，通常与 -i 同时使用
# -P 将容器内部端口随机映射到主机的高端口
# -p 将容器内部端口绑定到指定的主机端口
# -v [主机路径]:[镜像路径] 将主机目录挂载到镜像中
# --name 给容器命名
# --restart=[always | on-failure(:n)] #自动重启，错误重启(可以指定次数)

$docker search [image] #在线搜索可下载镜像

$docker pull [image] #下载镜像

$docker tag [imageId] [new REPOSITORY name]:[new TAG] #设置镜像标签

$docker rmi [imageId] #删除镜像
# -f 强制删除
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;http://www.runoob.com/docker/docker-run-command.html&quot;&gt;docker run 更多信息&lt;/a&gt;&lt;/p&gt;

&lt;h6 id=&quot;容器contain&quot;&gt;容器(contain)&lt;/h6&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$docker ps #列出正在运行的容器
# -a 列出所有容器包括已停止的
# -q 静默模式展示(只列出containId)

$docker port [contain] [port] #查看容器端口映射到主机端口的情况

$docker logs [contain] #可以查看容器内部的标准输出

$docker stop [contain] #停止容器

$docker start [contain] #运行容器

$docker restart [contain] #重启容器

$docker rm [contain] #删除容器(不能删除正在运行的容器)
#docker kill $(docker ps -a -q) 杀死所有正在运行的容器
#docker rm $(docker ps -a -q) 删除所有已经停止的容器

$docker exec [参数] [contain] [command] #在容器中执行命令
# -d 以守护进程方式运行（后台）
# -i 以交互模式运行容器，通常与 -t 同时使用
# -t 为容器重新分配一个伪输入终端，通常与 -i 同时使用

$docker attach [contain] #进入容器
#docker exec -it [contain] /bin/sh 也可以进入容器 前提是容器是运行中的

$docker top [contain] #查看容器中运行的进程

$docker diff [contain] #查看容器中的变化

$docker inspect [contain] #查看容器详细信息（输出为Json）

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h6 id=&quot;docker-hub&quot;&gt;Docker Hub&lt;/h6&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$docker login #登陆dockerHub

$docker commit -m=&quot;版本信息&quot; --author=&quot;作者&quot; [contain] [REPOSITORY:TAG] #构建镜像

$docker push [REPOSITORY:TAG] #将镜像推到dockerhub
#REPOSITORY 格式要求 user/repo
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;构建docker 镜像的常用方法是通过Dockerfile，这个以后有空再填这个坑&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2018/Docker/alpine.png&quot; alt=&quot;alpine&quot; /&gt;&lt;/p&gt;
&lt;center&gt;Alpine 最小的linux镜像&lt;/center&gt;

</description>
        <pubDate>Thu, 22 Mar 2018 20:00:00 +0800</pubDate>
        <link>http://localhost:4000/Outside-man.github.io/2018/03/22/docker/</link>
        <guid isPermaLink="true">http://localhost:4000/Outside-man.github.io/2018/03/22/docker/</guid>
        
        <category>docker</category>
        
        <category>技术</category>
        
        
      </item>
    
      <item>
        <title>为何要仰望星空</title>
        <description>&lt;p&gt;今天朋友圈直接被刷爆了，一颗物理界的巨星霍金逝世了。霍金对于我来说并不是很熟悉，以前初中中二的时候，啃过时间简史，也就是度过，套着里面一些生涩难懂的词汇，和初中的小伙伴侃侃大山。当我得知霍金逝世的时候，内心中还是怀着一定的伤感，白驹过隙，霍金致力于研究时间的，穷极一生证明时间的起点，到最后也还是阻挡不了时间无情地碾过。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2018/Hwaking/hwaking.jpg&quot; alt=&quot;Hwaking&quot; /&gt;&lt;/p&gt;
&lt;center&gt;霍金&lt;/center&gt;

&lt;p&gt;仔细了解霍金是从《万物理论》里面知道了霍金的人生，他这一生都被上帝玩弄着，有着极高的天赋和思想，却在早年就患上了肌肉萎缩的绝症，到后患肺炎，手术后他失去了说话的能力。他失去行动能力，甚至没有可以表达的能力。但是这一切都没有停止他的思维，只要大脑还能运作，思想就永无止步。&lt;/p&gt;

&lt;p&gt;对于物理我不甚了解，对于霍金的讣告，更多是他的一生的追求对我的触动。现在的我也面临着各种困难，我尚能行动，尚能表述，为何我会停下步伐。&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;
&lt;center style=&quot;font-style:oblique&quot;&gt;-为何要仰望星空&lt;/center&gt;
&lt;center style=&quot;font-style:oblique&quot;&gt;-因为大地在我的脚下&lt;/center&gt;
</description>
        <pubDate>Wed, 14 Mar 2018 20:00:00 +0800</pubDate>
        <link>http://localhost:4000/Outside-man.github.io/2018/03/14/Hawking/</link>
        <guid isPermaLink="true">http://localhost:4000/Outside-man.github.io/2018/03/14/Hawking/</guid>
        
        <category>生活</category>
        
        <category>霍金</category>
        
        
      </item>
    
      <item>
        <title>一次Redis被攻击的体验</title>
        <description>&lt;p&gt;今天本来高高兴兴地在开发项目，当我打开redis远程管理的时候突然发现，数据库中多了两条奇怪的数据。
&lt;img src=&quot;/img/in-post/2018/Redis-Attack/n1.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;center&gt;n1&lt;/center&gt;
&lt;p&gt;&lt;img src=&quot;/img/in-post/2018/Redis-Attack/n2.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;center&gt;n2&lt;/center&gt;

&lt;p&gt;我当时就发现这个ip我不认识啊，而且这个明显是cron的定时脚本，我心想不会是我开发的时候不小心把一些什么奇奇怪怪的东西写到redis里了吧。但是我的项目缓存没有持久的，这个TTL:-1让我觉得十分奇怪。&lt;/p&gt;

&lt;p&gt;抱着好奇，我把这个ip查一了一下 是加拿大的服务器。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2018/Redis-Attack/ip.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;center&gt;百度结果&lt;/center&gt;

&lt;p&gt;我心想我一个阿里云的学生服务器，我也没往墙外走过，这个肯定不是我主动造成。接着我尝试直接访问这个地址，看到的结果令我大吃一惊。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2018/Redis-Attack/db.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;center&gt;db.php&lt;/center&gt;
&lt;p&gt;这是shell脚本啊，我被攻击了。&lt;/p&gt;

&lt;p&gt;一直听闻网络黑客神乎其神，但是长在红旗下的我还真没怎么一对一遇到过黑客攻击，这一波我要仔细瞅瞅。问了一下专攻安全的学弟，才知道这个黑客的手段。&lt;/p&gt;

&lt;p&gt;大概攻击手段如下&lt;/p&gt;

&lt;p&gt;由于弱口令进入redis
本地生成公私钥文件，把公钥文件通过redis &amp;gt;config set 注到我的服务器中
通过本地私钥 ssh –i id_rsa root@xxx.xxx.xx.xx 直接获取服务器
不重视网络安全，活该被攻击，还好这台服务器只是我测试用的，最后解决办法，找到这段rsa删除，redis密码加强。仔细分析代码还被执行了”sr0.db”脚本，有可能是后门脚本。以后只能悠着点了。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2018/Redis-Attack/bqb.jpg&quot; alt=&quot;&quot; /&gt;
技术参考：&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://blog.knownsec.com/2015/11/analysis-of-redis-unauthorized-of-expolit/&quot;&gt;Redis 未授权访问配合 SSH key 文件利用分析&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Mon, 05 Mar 2018 20:00:00 +0800</pubDate>
        <link>http://localhost:4000/Outside-man.github.io/2018/03/05/Redis-Attack/</link>
        <guid isPermaLink="true">http://localhost:4000/Outside-man.github.io/2018/03/05/Redis-Attack/</guid>
        
        <category>网络安全</category>
        
        <category>服务器</category>
        
        <category>Redis</category>
        
        
      </item>
    
      <item>
        <title>有些人错过了，就是一辈子</title>
        <description>&lt;p&gt;今天看完《前任3》，影片开始还在吐槽剧情，看似分手，实则塞了观众满嘴口粮。一开场的，林佳来回进出房间，孟云在客厅坐立不安。发生的一切都好像是在说，这只是小打小闹，最终一定会和好的。&lt;/p&gt;

&lt;p&gt;王鑫，王梓的出现为最后的无法挽回打下了伏笔。作为观众能理解是误会，剧中的男女主却越走越远。&lt;/p&gt;

&lt;p&gt;在王梓知道孟云还想着林佳，把自己当做的替代品，却仍希望孟云能挽留自己。希望孟云能说出　
&lt;strong&gt;我爱你&lt;/strong&gt;，此时的孟云最可能说的是　&lt;strong&gt;对不起&lt;/strong&gt;，实在是放不下林佳。而林佳线中，面对王鑫的无限温柔之下，她一开始也是无法放下孟云。影片一直给观众呈现的感觉就是最终他们一定能复合。&lt;/p&gt;

&lt;p&gt;剧中有无数次可以复合的机会，一次次的失去。早些时候年轻的时候想着的是怎么这么矫情，现在渐渐也能感受到造物弄人的感觉。最终一对5年的恋人分开了，林佳最终再见的方式是狂吃会过敏的芒果，孟云则是穿上至尊宝站在城市街头。一段感情从此彻底断开，这突然起来的，真的是令人心里堵着。多希望其实影片还有5分钟，这一切都能复合。&lt;/p&gt;

&lt;p&gt;男女主错了吗？他们中没有人错，感情的事情没有对与错。热恋的时候永远不知道会因为什么分开，走着走着可能就分开了。就像剧中，开始问为什么分手，记不清了。却一直一直放不下，但也一直一直无法复合。&lt;/p&gt;

&lt;p&gt;整部剧表现形式虽然夸张，但是分手之后的那种情绪波动，非常能引起观众的共鸣。自己何尝也不是在经历一段感情之后，久久走不出来呢。或许是1个月或许是1年，或许是更久。&lt;/p&gt;

&lt;p&gt;珍惜眼前人，且行且珍惜。有些人错过了，就是一辈子。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2018/Ex-file/end.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
</description>
        <pubDate>Tue, 02 Jan 2018 20:00:00 +0800</pubDate>
        <link>http://localhost:4000/Outside-man.github.io/2018/01/02/The-Ex-file/</link>
        <guid isPermaLink="true">http://localhost:4000/Outside-man.github.io/2018/01/02/The-Ex-file/</guid>
        
        <category>生活</category>
        
        <category>影评</category>
        
        <category>前任3：再见前任</category>
        
        
      </item>
    
      <item>
        <title>minecraft开服实录</title>
        <description>&lt;h3 id=&quot;写在前面&quot;&gt;写在前面&lt;/h3&gt;
&lt;p&gt;Minecraft(简称Mc) 是一款从中学一直玩到大学都觉得非常好玩的游戏&lt;br /&gt;
但是以前和小伙伴玩的时候是通过蛤蟆吃或者是本地建服然后端口开放出去。这些方法都是中学的时候一点点看着论坛摸索出来的。之后进了大学就都是在寝室里局域网play。&lt;br /&gt;
这次有机会搞到了一台还不错的ubuntu的服务器，打算在上面建个服，然后放假了大家可以在家里玩。但是再liunx的服务器上，没有图形化界面 开服就没那么容易，就参考着资料试试看。&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;需要材料&quot;&gt;需要材料&lt;/h3&gt;
&lt;ol&gt;
  &lt;li&gt;jdk&lt;/li&gt;
  &lt;li&gt;minecraft_server.jar&lt;/li&gt;
  &lt;li&gt;forge-install.jar&lt;/li&gt;
  &lt;li&gt;forge-universal.jar&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;搞起以1710为例&quot;&gt;搞起(以1.7.10为例)&lt;/h3&gt;
&lt;p&gt;java环境就不多说了。直接创个目录就把上面三个jar丢进去。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;java -Xmx2048M -Xms2048M -XX:ParallelGCThreads=16 -jar minecraft_server.1.7.10.jar
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;blockquote&gt;
  &lt;p&gt;-Xmx最大内存 -Xms最小内存 -XX:ParallelGCThreads同时调用CPU数量，建议不设&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;第一次运行的时候 会要求签署EULA文件。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;eula=true
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;再次运行，这个时候一个&lt;strong&gt;纯净服务器&lt;/strong&gt;就开起来了。&lt;/p&gt;
&lt;h4 id=&quot;forge&quot;&gt;Forge&lt;/h4&gt;
&lt;p&gt;如果没有forge-install.jar、forge-universal.jar那就wget&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;wget http://files.minecraftforge.net/maven/net/minecraftforge/forge/1.7.10-10.13.2.1291/forge-1.7.10-10.13.2.1291-installer.jar
wget http://files.minecraftforge.net/maven/net/minecraftforge/forge/1.7.10-10.13.2.1291/forge-1.7.10-10.13.2.1291-universal.jar

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;有了之后就开始安装forge&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;java -jar forge-1.7.10-10.13.2.1291-installer.jar nogui --installServer
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;blockquote&gt;
  &lt;p&gt;同目录下必须有minecraft_server.1.7.10.jar，注意版本号&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;启动forge服务器&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;java -jar forge-1.7.10-10.13.2.1291-universal.jar
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;可以装mod的服务器就配置好了（撒花&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;如果是盗版服的话 修改server.properties 里的 online-mode=false&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;还有一点点&quot;&gt;还有一点点&lt;/h4&gt;
&lt;p&gt;这个时候在目录下面有两个jar(forge-install.jar安装完毕后就可以删除了),强迫症不能忍啊，整到一个jar里面&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mkdir tmp
cd tmp
tmp ../minecraft_server.1.7.10.jar
tmp ../forge-1.7.10-10.13.2.1291-universal.jar
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;blockquote&gt;
  &lt;p&gt;Archive: ../forge-1.7.10-10.13.2.1291-universal.jar &lt;br /&gt;
replace META-INF/MANIFEST.MF? [y]es, [n]o, [A]ll, [N]one, [r]ename: A&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;zip -r ../Forge-minecraft_server.1.7.10.jar *
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;这样的话可以就把server和forge里的东西整一块,把tmp文件夹以及之前的jar删除即可。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;完成之后的文件树

tree -L 1

├── banned-ips.json
├── banned-players.json
├── config
├── eula.txt
├── Forge-minecraft_server.1.7.10.jar
├── libraries
├── logs
├── mods
├── ops.json
├── server.properties
├── usercache.json
├── whitelist.json
└── world
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;打上mod，开始Mc之旅吧~&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;nohup java -Xmx2048M -Xms2048M -XX:ParallelGCThreads=16 -jar minecraft_server.1.7.10.jar &amp;amp;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</description>
        <pubDate>Fri, 22 Dec 2017 20:00:00 +0800</pubDate>
        <link>http://localhost:4000/Outside-man.github.io/2017/12/22/minecraft-server/</link>
        <guid isPermaLink="true">http://localhost:4000/Outside-man.github.io/2017/12/22/minecraft-server/</guid>
        
        <category>minecraft</category>
        
        
      </item>
    
      <item>
        <title>在linux系统自动备份数据库</title>
        <description>&lt;h3 id=&quot;背景交代&quot;&gt;背景交代&lt;/h3&gt;
&lt;p&gt;在给学校做一些项目的时候，会遇到学校工作人员误操作，导致数据库数据损坏。这时候我想阿里云的服务器肯定有mysql服务器的备份功能，然而要钱。&lt;br /&gt;
我就想自己实现自动备份&lt;br /&gt;
其实就是把备份命令写下来然后定时执行就行了。&lt;/p&gt;
&lt;h5 id=&quot;步骤&quot;&gt;步骤&lt;/h5&gt;
&lt;ol&gt;
  &lt;li&gt;安装crontabs&lt;/li&gt;
  &lt;li&gt;写好sh文件&lt;/li&gt;
  &lt;li&gt;创建定时任务&lt;/li&gt;
&lt;/ol&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;尝试开始&quot;&gt;尝试开始&lt;/h2&gt;
&lt;h3 id=&quot;1-crontabs&quot;&gt;1. crontabs&lt;/h3&gt;

&lt;p&gt;学校用了新的服务器 很多没有配置&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;apt-get install cron
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;惊奇发现 阿里云已经有了crontabs&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;cron is already the newest version (3.0pl1-128ubuntu2).&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;2-sh文件&quot;&gt;2. sh文件&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;backupdir=/home/backup/backup
#定义变量backupdir  备份数据之后放到哪里

time='date +%Y%m%d%H'
#定义时间变量

mysqldump 数据库名 &amp;gt; $backupdir/备份名_$(date +%Y_%m_%d_%H%M%S).sql
#通过mysqldump指令指定数据库备份，通过管道备份为backupdir下的 以备份名_时间命名的.sql文件

find $backupdir -name &quot;sztw_*.sql&quot; -type f -mtime +30 -exec rm {}\; &amp;gt; /dev/null 2&amp;gt;&amp;amp;1
#find $backupdir -name &quot;sztw_*.sql&quot; -type f -mtime +30 -exec rm {}\;
#找到打包文件夹下面的备份文件 类型普通文件，时间超过30日的删除
#&amp;gt; /dev/null 2&amp;gt;&amp;amp;1 
#这个是让如果有输出指令不要打印
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;写完sh 别忘了把文件权限为可执行chmod u+x xxxxx.sh&lt;br /&gt;
然后尝试 ./xxxxx.sh 执行一发&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vim /etc/mysql/my.cnf
#里的末尾添加
[mysqldump]
user='username'
password='password'
#这样就可以在备份的时候自动登入数据库账号
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h3 id=&quot;3创建定时任务&quot;&gt;3.创建定时任务&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;crontab -e

#进入到任务编辑文件 添加任务
0 0 * * * /xxxxx.sh  #所在文件
#表示每天的0:00执行sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;crontab 中前面五个值分别表示分钟、小时、几号、月份、周几&lt;br /&gt;
(*)表示所有可能&lt;br /&gt;
(,)逗号隔开几个表示列表范围 如1,3,5&lt;br /&gt;
(-)表示整数范围 如2-6&lt;br /&gt;
(/)表示时间频率 0-23/2 每两小时一次 */10每十分钟一次&lt;/p&gt;

&lt;p&gt;完成后重启下crontabs服务&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;service cron restart
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;到此大功告成&lt;/p&gt;
</description>
        <pubDate>Tue, 12 Dec 2017 20:00:00 +0800</pubDate>
        <link>http://localhost:4000/Outside-man.github.io/2017/12/12/database-backup/</link>
        <guid isPermaLink="true">http://localhost:4000/Outside-man.github.io/2017/12/12/database-backup/</guid>
        
        <category>服务器</category>
        
        <category>Linux</category>
        
        <category>技术</category>
        
        
      </item>
    
  </channel>
</rss>
